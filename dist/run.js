!function(){const e=(e,t,n)=>{let o=typeof e!==t;return o&&console.error(`${n} 只支持object，当前是 ${typeof e}!`),o};let t,n;const o=()=>{n&&n.disconnect(),t&&t.remove()},r=(a,i={},d={})=>{if(e(i,"object","canvasOpt"))return;if(e(d,"object","warStyle"))return;if(!a)return;o();let l=e=>document.getElementById(e),c=document.body.clientWidth||document.body.offsetWidth,m=window.parseInt(c,10),s=m/window.parseInt(m/200),u=window.getComputedStyle(document.body)["font-family"],w=document.createElement("canvas");w.width=i?.width||s,w.height=i?.height||150;let f=w.getContext("2d");f.font=`${i?.fontSize||"16px"} ${i?.fontFamily||u}`,f.fillStyle=i?.fillStyle||"rgba(8, 8, 8, 0.08)",f.rotate(i?.rotate||-.29),f.fillText(a,i?.fillX||0,i?.fillY||80);const p=w.toDataURL("image/webp"),b=0===p.indexOf("data:image/webp");let g=p;i?.imgType&&(g=w.toDataURL(i?.imgType)),b||(g=w.toDataURL("image/png"));const h=document.createDocumentFragment();t=document.createElement("div"),t.id="water-mark",t.style.cssText+=`\n            width: 100%;\n            height: 100%;\n            top:0;\n            left:0;\n            position: fixed;\n            overflow: hidden;\n            z-index: 9999;\n            pointer-events: none;\n            background-repeat: repeat, repeat;\n            background-position: ${w.width/1.5}px ${w.height/1.4}px;\n            background-image: url("${g}");\n      `;for(let e in d)t.style[e]=d[e];const y=document.querySelector("body");document.createElement("div").id="war",h.appendChild(t),l(t.id)||(y?y.appendChild(h):console.error("水印加载失败"));const v=e=>{e.remove(),r(a,i,d)};let k=l("water-mark");let x=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;return n=new x((e=>{for(let t of e){if("water-mark"===t.oldValue||"water-mark"===t.target.id){v(k);break}for(let e of[...t.removedNodes,...t.addedNodes])if("water-mark"===e.id){v(k);break}}})),n.observe(y,{childList:!0,attributes:!0,characterData:!0,subtree:!0,attributeOldValue:!0,characterDataOldValue:!0}),o};window.canvansWatermark=r,window.unObserver=o}();
