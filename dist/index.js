const e=(e,t,o)=>{let n=typeof e!==t;return n&&console.error(`${o} 只支持object，当前是 ${typeof e}!`),n};let t,o;const n=()=>{o&&o.disconnect(),t&&t.remove()},r=(a,i={},d={})=>{if(e(i,"object","canvasOpt"))return;if(e(d,"object","warStyle"))return;if(!a)return;n();let l=e=>document.getElementById(e),c=document.body.clientWidth||document.body.offsetWidth,m=window.parseInt(c,10),s=m/window.parseInt(m/200),u=window.getComputedStyle(document.body)["font-family"],f=document.createElement("canvas");f.width=i?.width||s,f.height=i?.height||150;let w=f.getContext("2d");w.font=`${i?.fontSize||"16px"} ${i?.fontFamily||u}`,w.fillStyle=i?.fillStyle||"rgba(8, 8, 8, 0.08)",w.rotate(i?.rotate||-.29),w.fillText(a,i?.fillX||0,i?.fillY||80);const p=f.toDataURL("image/webp"),b=0===p.indexOf("data:image/webp");let g=p;i?.imgType&&(g=f.toDataURL(i?.imgType)),b||(g=f.toDataURL("image/png"));const h=document.createDocumentFragment();t=document.createElement("div"),t.id="water-mark",t.style.cssText+=`\n          width: 100%;\n          height: 100%;\n          top:0;\n          left:0;\n          position: fixed;\n          overflow: hidden;\n          z-index: 9999;\n          pointer-events: none;\n          background-repeat: repeat, repeat;\n          background-position: ${f.width/1.5}px ${f.height/1.4}px;\n          background-image: url("${g}");\n    `;for(let e in d)t.style[e]=d[e];const y=document.querySelector("body");document.createElement("div").id="war",h.appendChild(t),l(t.id)||(y?y.appendChild(h):console.error("水印加载失败"));const v=e=>{e.remove(),r(a,i,d)};let k=l("water-mark");let x=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;return o=new x((e=>{for(let t of e){if("water-mark"===t.oldValue||"water-mark"===t.target.id){v(k);break}for(let e of[...t.removedNodes,...t.addedNodes])if("water-mark"===e.id){v(k);break}}})),o.observe(y,{childList:!0,attributes:!0,characterData:!0,subtree:!0,attributeOldValue:!0,characterDataOldValue:!0}),n};export{r as createWaterMark,n as unObserver};
